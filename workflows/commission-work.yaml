id: commission-work
name: Commission Work
description:
  Default workflow that drives planning artifacts through module engine
runtime:
  max_parallel: 3

modules:
  - id: anchor-docs
    module: anchor-docs
    name: Create Anchor Documents
    description:
      Generates COMMISSION.md, ARCHITECTURE.md, and CONVENTIONS.md via the
      planning skill.

  - id: action-plan
    module: action-plan
    name: Create Action Plan
    description: Produces MODULES.md and PLAN.md from the anchor documents.
    depends_on: [anchor-docs]

  - id: staff-review
    module: staff-review
    name: Staff Engineer Review
    description:
      Runs the staff engineer feedback cycle over MODULES.md and PLAN.md.
    depends_on: [action-plan]

  - id: staff-incorporate
    module: staff-incorporate
    name: Incorporate Staff Feedback
    description:
      Applies the Staff Engineer review to the plan and records the readiness
      marker.
    depends_on: [staff-review]

  - id: parallel-reviews
    module: parallel-reviews
    name: Parallel Reviewer Personas
    description:
      Runs the four persona reviewers against the plan in parallel tmux
      sessions.
    depends_on: [staff-incorporate]

  - id: consolidation
    module: consolidation
    name: Consolidate Reviews
    description:
      Synthesizes reviewer feedback into the plan and sets the reviews-applied
      marker.
    depends_on: [parallel-reviews]

  - id: bead-creation
    module: bead-creation
    name: Create Beads
    description: Converts the consolidated plan into beads for scheduling.
    depends_on: [consolidation]

  - id: orchestrator-selection
    module: orchestrator-selection
    name: Select Orchestrator
    description:
      Locks the orchestrator roster, writes workflow/orchestrator.json, and
      snapshots workers.json for downstream staffing modules.
    depends_on: [bead-creation]

  - id: hiring
    module: hiring
    name: Hire Workers
    description:
      Builds the worker roster, generates AGENT briefs, and prepares support
      packets so work cycles can be scheduled.
    depends_on: [orchestrator-selection]

  - id: work-process
    module: work-process
    name: Run Work Cycle
    description:
      Dispatches work sessions through the orchestrator, writes work logs, and
      emits the work completion markers consumed by refinement and release.
    depends_on: [hiring]

  - id: refinement
    module: refinement
    name: Run Refinement Audits
    description:
      Drives stakeholder audits and only runs when the refinement-needed marker
      is present; clears it once audits and follow-up cycles finish.
    depends_on: [work-process]

  - id: release
    module: release
    name: Finalize Release
    description:
      Packages artifacts, writes release notes, resets runtime directories, and
      emits the release markers before the next commission.
    depends_on: [refinement]
